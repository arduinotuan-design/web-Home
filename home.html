<!DOCTYPE html>
<html lang="vi">
<head>
    <script>
        // B·∫¢O V·ªÜ: Ki·ªÉm tra th·∫ª b√†i ngay l·∫≠p t·ª©c
        if (localStorage.getItem('isLoggedIn') !== 'true' || !localStorage.getItem('userPass')) {
            window.location.replace('index.html'); 
        }
    </script>
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/628/628283.png">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <title>Demo Mobile App T@ Smart</title>
    <style>
        /* CSS C·ª¶A B·∫†N (GI·ªÆ NGUY√äN) */
        .card { background: transparent !important; padding: 0; margin-bottom: 18px; border: none; box-shadow: none; }
        .device-card { background: transparent !important; border-radius: 0; padding: 0; }
        .product-banner { width: 100%; height: 180px; background: #3498db; border-radius: 0px; margin-bottom: 15px; display: flex; align-items: flex-end; overflow: hidden; position: relative; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .banner-text { background: rgba(0, 0, 0, 0.4); color: white; width: 100%; padding: 8px 15px; font-size: 14px; font-weight: bold; backdrop-filter: blur(2px); }
        :root { --bg: #f0f2f5; --primary: #1a73e8; --on-active: #2ecc71; --on-dim: #e8f5e9; --off-active: #7f8c8d; --off-dim: #f5f5f5; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 10px; padding-bottom: 120px !important; background: linear-gradient(180deg,#D6E8F5 0%,#D6E8F5 100%); }
        .system-sync { border: 1.5px solid rgba(255, 255, 255, 0.65); border-radius: 2px; padding: 12px 14px; margin: 10px 0; background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(4px); }
        .grid-container { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
        .device-img { width: 100%; height: 130px; object-fit: cover; border-radius: 2px; display: block; margin: 0 auto; }
        [id^="name-device-"] { font-size: 12px !important; font-weight: bold; margin-top: 15px !important; margin-bottom: 10px; color: #333; display: block; }
     



    /* T√πy ch·ªânh l·∫°i nh√≥m n√∫t cho hi·ªán ƒë·∫°i */
/* T√πy ch·ªânh nh√≥m n√∫t c√°ch xa nhau nh∆∞ b·∫°n mu·ªën */
/* Nh√≥m n√∫t c√°ch xa nhau 30px ƒë·ªÉ kh√¥ng b·∫•m nh·∫ßm */
.btn-group { 
    display: flex; 
    gap: 25px; 
    justify-content: center; 
    margin-top: 12px; 
}

/* N√∫t b·∫•m n·ªÅn k√≠nh m·ªù */
.btn { 
    height: 25px; 
    width: 50px; 
    font-size: 10px; 
    border-radius: 5px; 
    font-weight: bold; 
    display: inline-flex; 
    align-items: center; 
    justify-content: center; 
    transition: all 0.2s ease;
    border: 1px solid rgba(255, 255, 255, 0.3); /* Vi·ªÅn k√≠nh */
    background: rgba(255, 255, 255, 0.1); 
    backdrop-filter: blur(5px);
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    color: #666; /* M√†u ch·ªØ khi ch∆∞a ch·ªçn */
}

/* M√ÄU B·∫¨T (Xanh l√° - Gi·ªØ t√¥ng c≈© c·ªßa b·∫°n nh∆∞ng l√†m 3D) */
.active-on { 
    background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%) !important; 
    color: white !important; 
    border: none;
    box-shadow: 0 4px 12px rgba(46, 204, 113, 0.4);
    transform: translateY(-2px); /* N·ªïi l√™n */
}

/* M√ÄU T·∫ÆT (X√°m - Gi·ªØ t√¥ng c≈© c·ªßa b·∫°n nh∆∞ng l√†m 3D) */
  .active-off { background: var(--off-active) !important; color: white !important; }
     

/* Hi·ªáu ·ª©ng khi ng√≥n tay nh·∫•n xu·ªëng */
.btn:active {
    transform: scale(0.92);
    box-shadow: none;
}




        .bottom-menu { position: fixed; bottom: 0; left: 0; right: 0; display: flex; justify-content: space-around; align-items: center; padding: 10px 5px 25px 5px; background: #f0f2f5; z-index: 1000; }
        .nav-item { background: white; width: 22%; height: 65px; border-radius: 12px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(0,0,0,0.1); cursor: pointer; color: #2c3e50; transition: 0.2s; }
        .nav-item.active { color: #1a73e8; border: 1.5px solid #1a73e8; }
        .nav-item i { font-size: 20px; margin-bottom: 4px; }
        .nav-item span { font-size: 10px; font-weight: bold; }
          .nav-item:active { transform: scale(0.9); background: #e8f0fe; }
      
        .hidden { display: none !important; }
        .input-group { display: flex; gap: 5px; margin-bottom: 10px; }
        input, select { padding: 8px; border: 1px solid #ddd; border-radius: 5px; flex: 1; }
        .list-box { border: 1px solid #eee; padding: 10px; border-radius: 5px; margin-bottom: 10px; min-height: 40px; background: #fafafa; }
        .list-item { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #eee; font-size: 13px; }
        .btn-del { color: red; cursor: pointer; font-weight: bold; padding: 0 10px; }
        .btn-save { width: 100%; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .device-img:active { transform: scale(0.95); opacity: 0.8; }
       
        body { padding-bottom: 100px !important; }

        
        /* CSS M·ªöI CHO TRANG L·ªäCH ƒê√àN */
        .flex-container { display: flex; gap: 5px; align-items: center; margin-bottom: 10px; }
        #page-schedule { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-top: 10px; }
        .btn-save:active {
    transform: scale(0.96);
    filter: brightness(0.9);
    transition: 0.1s;
}
   </style>
</head>
<body>

    <div id="page-home">
        <div class="banner-text">
            <i class="fa-solid fa-leaf"></i> H·ªá Th·ªëng T@ Smart - N√¢ng T·∫ßm Cu·ªôc S·ªëng
        </div>
        <div class="product-banner">
            <img src="https://images.unsplash.com/photo-1558002038-1055907df827?w=1200" 
                 style="width: 100%; height: 100%; object-fit: cover; position: absolute;">
        </div>

        <div class="card">
            <h3 style="color: #1a73e8; font-weight: 800; margin-bottom: 15px;">
                <i class="fa-solid fa-microchip"></i> ƒêi·ªÅu khi·ªÉn thi·∫øt b·ªã
            </h3>
            <div id="device_list" class="grid-container"></div>
        </div>

        <div class="system-sync" style="display: flex; justify-content: space-between; align-items: center;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <div id="status-indicator" style="width: 12px; height: 12px; background: #95a5a6; border-radius: 50%;"></div>
                <span style="font-weight: 800; font-size: 12px;">H·ªÜ TH·ªêNG</span>
            </div>
            <button onclick="updateStatusOnly()" class="btn-save" style="width: auto; padding: 5px 15px; background: #3498db; font-size: 11px;">
                ƒê·ªíNG B·ªò
            </button>
        </div>
         


        <div class="card" style="background: rgba(255, 255, 255, 0.8) !important; padding: 20px; border-radius: 24px; border: 1px solid rgba(255, 255, 255, 0.5); backdrop-filter: blur(10px); box-shadow: 0 10px 25px rgba(0,0,0,0.05); margin: 15px 0;">
    
    <h3 style="font-weight: 800; color: #2c3e50; margin-bottom: 20px; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; display: flex; align-items: center; gap: 8px;">
        <i class="fa-solid fa-gears text-blue-500"></i> C√ÄI ƒê·∫∂T H·ªÜ TH·ªêNG
    </h3>
    
    <button class="btn-save" style="background: linear-gradient(135deg, #0d9488 0%, #0b7a6f 100%); margin-bottom: 15px; border-radius: 16px; height: 58px; box-shadow: 0 4px 12px rgba(13, 148, 136, 0.3); border: none;" onclick="gotoPage('watering')">
        <div style="display: flex; align-items: center; justify-content: center; gap: 12px;">
            <i class="fa-solid fa-droplet" style="font-size: 18px;"></i>
            <span style="font-size: 14px; letter-spacing: 0.5px;">L·ªäCH T∆Ø·ªöI LAN T·ª∞ ƒê·ªòNG</span>
        </div>
    </button>
    
    <button class="btn-save" style="background: linear-gradient(135deg, #4b5563 0%, #374151 100%); border-radius: 16px; height: 58px; box-shadow: 0 4px 12px rgba(75, 85, 99, 0.3); border: none;" onclick="gotoPage('schedule')">
        <div style="display: flex; align-items: center; justify-content: center; gap: 12px;">
            <i class="fa-solid fa-lightbulb" style="font-size: 18px;"></i>
            <span style="font-size: 14px; letter-spacing: 0.5px;">C√ÄI ƒê·∫∂T L·ªäCH ƒê√àN 10 PH√íNG</span>
        </div>
    </button>
</div>


    </div>

    <div id="page-schedule" class="hidden" style="padding: 15px; max-width: 500px; margin: auto;">
    <div onclick="gotoPage('home')" style="margin-bottom:20px; cursor:pointer; color: #1a73e8; font-weight:bold; display: flex; align-items: center; gap: 8px;">
        <i class="fa-solid fa-circle-left" style="font-size: 20px;"></i> Tr·ªü v·ªÅ trang ch·ªß
    </div>

    <div style="background: white; padding: 20px; border-radius: 20px; border: 1px solid #eee;">
        <h3 style="font-weight:800; margin-bottom:15px; color: #333; display: flex; align-items: center; gap: 10px;">
            <i class="fa-solid fa-stopwatch text-orange-500"></i> H·∫∏N GI·ªú THI·∫æT B·ªä
        </h3>
        <label style="font-size: 12px; font-weight: bold; color: #666; margin-left: 5px;">CH·ªåN PH√íNG/ƒê√àN:</label>
        <select id="v10_id" onchange="loadRoomSchedules()" style="width: 100%; padding: 12px; border-radius: 12px; border: 1.5px solid #eee; margin-top: 5px; margin-bottom: 20px; font-weight: bold; background: #f9f9f9;">
            <option value="">ƒêang t·∫£i danh s√°ch...</option>
        </select>

        <div style="display: grid; grid-template-columns: 1fr 1fr 50px; gap: 10px; align-items: end;">
            <div>
                <label style="font-size: 11px; font-weight: bold; color: #2ecc71;">GI·ªú B·∫¨T</label>
                <input type="time" id="v10_on" style="width: 100%; padding: 10px; border-radius: 10px; border: 1.5px solid #eee;">
            </div>
            <div>
                <label style="font-size: 11px; font-weight: bold; color: #e74c3c;">GI·ªú T·∫ÆT</label>
                <input type="time" id="v10_off" style="width: 100%; padding: 10px; border-radius: 10px; border: 1.5px solid #eee;">
            </div>
            <button onclick="addV10()" style="height: 42px; background: #1a73e8; color: white; border-radius: 10px; border: none; font-size: 20px;">+</button>
        </div>
    </div>
    <div id="v10_list" style="margin-top: 20px;"></div>
    <button class="btn-save" style="background: linear-gradient(90deg, #2ecc71, #27ae60); margin-top:20px; height: 50px; border-radius: 15px;" onclick="saveAllV10(this)">
        <i class="fa-solid fa-paper-plane"></i> G·ª¨I L·ªäCH L√äN ESP32
    </button>
</div>

<div id="page-watering" class="hidden" style="padding: 15px; max-width: 500px; margin: auto;">
    <div onclick="gotoPage('home')" style="margin-bottom:20px; cursor:pointer; color: #0d9488; font-weight:bold; display: flex; align-items: center; gap: 8px;">
        <i class="fa-solid fa-circle-left" style="font-size: 20px;"></i> Tr·ªü v·ªÅ trang ch·ªß
    </div>

    <div style="background: white; padding: 20px; border-radius: 20px; border: 1px solid #eee;">
        <h3 style="font-weight:800; margin-bottom:15px; color: #0d9488; display: flex; align-items: center; gap: 10px;">
            <i class="fa-solid fa-droplet"></i> L·ªäCH T∆Ø·ªöI T·ª∞ ƒê·ªòNG
        </h3>
        <p style="font-size: 12px; color: #666; margin-bottom: 15px;">B·∫°n c√≥ th·ªÉ c√†i ƒë·∫∑t t·ªëi ƒëa 6 l·∫ßn t∆∞·ªõi trong ng√†y.</p>

        <div style="display: grid; grid-template-columns: 1.5fr 1fr 50px; gap: 10px; align-items: end;">
            <div>
                <label style="font-size: 11px; font-weight: bold; color: #666;">GI·ªú T∆Ø·ªöI</label>
                <input type="time" id="v2_t" style="width: 100%; padding: 10px; border-radius: 10px; border: 1.5px solid #eee;">
            </div>
            <div>
                <label style="font-size: 11px; font-weight: bold; color: #666;">PH√öT</label>
                <input type="number" id="v2_d" placeholder="V√≠ d·ª•: 5" style="width: 100%; padding: 10px; border-radius: 10px; border: 1.5px solid #eee;">
            </div>
            <button onclick="addV2()" style="height: 42px; background: #0d9488; color: white; border-radius: 10px; border: none; font-size: 20px;">+</button>
        </div>
    </div>

    <div id="v2_list_ui" style="margin-top: 20px; space-y: 10px;">
        </div>

    <button class="btn-save" style="background: #0d9488; margin-top:20px; height: 50px; border-radius: 15px;" onclick="saveV2(this)">
        <i class="fa-solid fa-cloud-arrow-up"></i> L∆ØU L·ªäCH T∆Ø·ªöI L√äN ESP32
    </button>
</div>

    <div id="page-alarm" class="hidden">
        <div class="card" style="text-align: center; position: relative; background:white !important; padding:15px; border-radius:10px;">
            <div onclick="gotoPage('home')" style="position: absolute; left: 15px; top: 18px; cursor: pointer; color: var(--primary);">
                <i class="fa-solid fa-chevron-left"></i> Quay l·∫°i
            </div>
            <h3 style="font-weight: bold; font-size: 18px; margin-bottom: 20px;">C·∫•u h√¨nh Telegram</h3>
            <hr>
            
            <div style="text-align: left; margin-top: 20px;">
                <label><b>Telegram Token:</b></label>
                <input type="text" id="tg_token" style="width:100%; padding:10px; margin:8px 0 15px; border:1px solid #ddd; border-radius:8px;" placeholder="Bot Token c·ªßa b·∫°n...">
                
                <label><b>Telegram Chat ID:</b></label>
                <input type="text" id="tg_id" style="width:100%; padding:10px; margin:8px 0 15px; border:1px solid #ddd; border-radius:8px;" placeholder="ID ng∆∞·ªùi nh·∫≠n...">
                
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 25px;">
                    <input type="checkbox" id="tg_active" onchange="sendCmd('V14', this.checked ? 1 : 0)" style="width: 20px; height: 20px;" checked>
                    <label for="tg_active" style="color: blue; font-weight: bold; cursor: pointer;">B·∫≠t th√¥ng b√°o chu√¥ng</label>
                </div>

                <button onclick="saveTelegram()" style="width: 100%; padding: 12px; background: #3498db; color: white; border: none; border-radius: 8px; font-weight: bold; margin-bottom: 10px;">L∆ØU V√Ä C·∫¨P NH·∫¨T</button>
                <button onclick="clearAllData()" style="width: 100%; padding: 12px; background: #e74c3c; color: white; border: none; border-radius: 8px; font-weight: bold;">X√ìA T·∫§T C·∫¢ (KHI B√ÄN GIAO M√ÅY)</button>
            </div>
        </div>
    </div>

    <div class="bottom-menu">
        <div class="nav-item active" id="nav-home" onclick="gotoPage('home')">
            <i class="fa-solid fa-house"></i>
            <span>Trang Ch·ªß</span>
        </div>
        <div class="nav-item" onclick="alert('T√≠nh nƒÉng video ƒëang c·∫≠p nh·∫≠t')">
            <i class="fa-solid fa-video"></i>
            <span>Video</span>
        </div>
        <div class="nav-item" id="nav-alarm" onclick="gotoPage('alarm')">
            <i class="fa-solid fa-bell"></i>
            <span>Th√¥ng B√°o</span>
        </div>
        <div class="nav-item" onclick="logout()">
            <i class="fa-solid fa-arrow-right-from-bracket"></i>
            <span>ƒêƒÉng Xu·∫•t</span>
        </div>
    </div>
    
   

    <script>
        // C·∫§U H√åNH
        const WORKER_URL = "https://blynk-token-proxy.tanthanhlttb123.workers.dev";
        const DEVICE_NAME = "cay";
        const isLocal = false;
        
        let customNames = {};
        let listV2 = [], listV10 = [];
        let clickCounter = 0; // Th√™m d√≤ng n√†y
        let pendingChecks = {}; // Th√™m d√≤ng n√†y
        const allPins = ["V1", "V3", "V4", "V5", "V6", "V7", "V8", "V9", "V10", "V11", "V12"];
        const v10Mapping = {
            "1":"V3", "2":"V4", "3":"V5", "4":"V6", "5":"V7", 
            "6":"V8", "7":"V9", "8":"V10", "9":"V11", "10":"V12" 
        };


        // H√†m t·∫°o √¢m thanh c√¥ng t·∫Øc c∆° (C·ª•p)
// ƒê·∫∑t bi·∫øn n√†y ra ngo√†i h√†m ƒë·ªÉ d√πng chung (tr√°nh b·ªã treo AudioContext)
let sharedAudioCtx = null;

function playClickSound() {
    try {
        // Kh·ªüi t·∫°o m·ªôt l·∫ßn duy nh·∫•t, n·∫øu c√≥ r·ªìi th√¨ d√πng l·∫°i
        if (!sharedAudioCtx) {
            sharedAudioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }
        
        // Lu√¥n ƒë√°nh th·ª©c AudioContext n·∫øu tr√¨nh duy·ªát t·∫°m d·ª´ng n√≥
        if (sharedAudioCtx.state === 'suspended') {
            sharedAudioCtx.resume();
        }

        const oscillator = sharedAudioCtx.createOscillator();
        const gainNode = sharedAudioCtx.createGain();

        // ƒê√ÇY L√Ä TH√îNG S·ªê TI·∫æNG "C·ª§P" C≈® B·∫†N TH√çCH
        oscillator.type = 'sine'; 
        oscillator.frequency.setValueAtTime(150, sharedAudioCtx.currentTime); 
        oscillator.frequency.exponentialRampToValueAtTime(0.01, sharedAudioCtx.currentTime + 0.1);

        gainNode.gain.setValueAtTime(0.2, sharedAudioCtx.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, sharedAudioCtx.currentTime + 0.1);

        oscillator.connect(gainNode);
        gainNode.connect(sharedAudioCtx.destination);

        oscillator.start();
        oscillator.stop(sharedAudioCtx.currentTime + 0.1);
    } catch (e) {
        console.log("L·ªói √¢m thanh:", e);
    }
}
        // H√†m chuy·ªÉn trang m∆∞·ª£t m√†
        function gotoPage(p) {
    // ·∫®n t·∫•t c·∫£ c√°c trang
    document.getElementById('page-home').classList.add('hidden');
    document.getElementById('page-schedule').classList.add('hidden');
    document.getElementById('page-alarm').classList.add('hidden');
    document.getElementById('page-watering').classList.add('hidden'); // Th√™m d√≤ng n√†y n·∫øu ch∆∞a c√≥

    // Hi·ªán trang ƒë∆∞·ª£c ch·ªçn
    document.getElementById('page-' + p).classList.remove('hidden');

    // C·∫≠p nh·∫≠t tr·∫°ng th√°i menu
    document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
    if(p === 'home') document.getElementById('nav-home').classList.add('active');
    if(p === 'alarm') document.getElementById('nav-alarm').classList.add('active');

    // Ch·ªâ load l·ªãch khi th·ª±c s·ª± v√†o trang ƒë√≥
    if(p === 'schedule') loadRoomSchedules();
}

        document.addEventListener("DOMContentLoaded", function() {
            let cachedNames = localStorage.getItem('last_config');
            let cachedV2 = localStorage.getItem('v2_list_cache');
            let cachedV10 = localStorage.getItem('v10_list_cache');

            if(cachedNames) customNames = JSON.parse(cachedNames);
            if(cachedV2) listV2 = JSON.parse(cachedV2);
            if(cachedV10) listV10 = JSON.parse(cachedV10);
            
            renderUI();
            updateStatusOnly();
        });

        function renderUI() {
            let h = "";
            allPins.forEach(p => {
                let savedImg = localStorage.getItem('img_' + p);
                let imgSrc = savedImg || "https://cdn-icons-png.flaticon.com/512/628/628283.png";

                h += `<div class="device-card">
                    <img id="img-tag-${p}" src="${imgSrc}" class="device-img" 
                         onclick="uploadImg('${p}')"
                         onerror="this.src='https://via.placeholder.com/150/cccccc/ffffff?text=No+Image'">
                    <span id="name-device-${p}" style="cursor:pointer; font-weight:bold; margin-top:5px; display:block;" onclick="editName('${p}')">
                        ${customNames[p] || p} ‚úèÔ∏è
                    </span>
                    <div class="btn-group">
                        <button id="on-${p}" class="btn btn-on" onclick="sendCmd('${p}',1)">B·∫¨T</button>
                        <button id="off-${p}" class="btn btn-off" onclick="sendCmd('${p}',0)">T·∫ÆT</button>
                    </div>
                </div>`;
            });
            document.getElementById('device_list').innerHTML = h;

            // Load options cho V10
            let opt = "";
            for (let id in v10Mapping) {
                opt += `<option value="${id}">${customNames[v10Mapping[id]] || ("ƒê√®n " + id)}</option>`;
            }
            let v10Select = document.getElementById('v10_id');
            if(v10Select) v10Select.innerHTML = opt;

            let v2Html = listV2.map((x, i) => `
        <div style="background: white; padding: 12px 15px; border-radius: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; border-left: 5px solid #0d9488; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
            <div>
                <div style="font-size: 14px; font-weight: bold; color: #333;">L·∫ßn t∆∞·ªõi ${i+1}</div>
                <div style="font-size: 12px; color: #666;">
                    <i class="fa-regular fa-clock"></i> ${x.t} ‚Äî <i class="fa-solid fa-hourglass-half"></i> ${x.d} ph√∫t
                </div>
            </div>
            <span class="btn-del" onclick="removeV2(${i})" style="background: #fee2e2; color: #ef4444; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                <i class="fa-solid fa-trash-can" style="font-size: 12px;"></i>
            </span>
        </div>
    `).join('');

    document.getElementById('v2_list_ui').innerHTML = v2Html || '<div style="text-align:center; color:#ccc; padding:20px;">Ch∆∞a c√≥ l·ªãch t∆∞·ªõi</div>';
    
    // X√≥a c√°i d√≤ng c≈© n√†y ƒëi n·∫øu b·∫°n d√πng ID m·ªõi: document.getElementById('v2_list').innerHTML = ...
   
        }

        function openSchedule(pin) {
            gotoPage('schedule');
            let id = Object.keys(v10Mapping).find(key => v10Mapping[key] === pin);
            if (id) document.getElementById("v10_id").value = id;
            loadRoomSchedules();
        }
        //1111111111
       function loadRoomSchedules() {
    let roomId = document.getElementById('v10_id').value;
    if (!roomId) return;

    // Thay v√¨ d√πng .map c·ªßa roomSchedules, ta duy·ªát listV10 g·ªëc ƒë·ªÉ l·∫•y ƒë√∫ng s·ªë th·ª© t·ª± (index)
    let html = "";
    listV10.forEach((x, index) => {
        if (String(x.id) === String(roomId)) {
            let tenPhong = customNames[v10Mapping[x.id]] || 'ƒê√®n ' + x.id;
            html += `
            <div class="list-item" style="display: flex; align-items: center; justify-content: space-between; background: #fff; margin-bottom: 5px; padding: 12px; border-radius: 8px; border-left: 4px solid var(--primary); box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                <div style="flex: 1;">
                    <b style="color:var(--primary)">${tenPhong}:</b> 
                    <span style="font-size: 13px; margin-left:10px;">${x.on} ‚ûî ${x.off}</span>
                </div>
                <div style="display: flex; gap: 10px;">
                    <span class="btn-del" onclick="removeV10(${index})" style="color: #e74c3c; cursor: pointer; font-weight: bold; padding: 5px 15px; background: #fdf2f2; border-radius: 5px;">‚úñ</span>
                </div>
            </div>`;
        }
    });

    document.getElementById('v10_list').innerHTML = html || '<div style="color:#ccc;text-align:center; padding:20px;">Ch∆∞a c√≥ l·ªãch ƒë∆∞·ª£c t·∫°o cho ph√≤ng n√†y</div>';
}

        function addV10() {
            let roomId = document.getElementById('v10_id').value;
            let on = document.getElementById('v10_on').value;
            let off = document.getElementById('v10_off').value;
            if(!on || !off) return alert("Ch·ªçn ƒë·ªß gi·ªù!");
            
            listV10.push({id: roomId, on: on, off: off});
            localStorage.setItem('v10_list_cache', JSON.stringify(listV10));
            loadRoomSchedules();
        }
        

// --- H√ÄM X√ìA ƒê√É S·ª¨A L·∫†I THEO ƒê√öNG √ù B·∫†N ---
function removeV10(i) {
    if(confirm("X√≥a l·ªãch n√†y v√† c·∫≠p nh·∫≠t l√™n thi·∫øt b·ªã ngay?")) {
        // 1. X√°c ƒë·ªãnh d·ªØ li·ªáu tr∆∞·ªõc khi x√≥a
        const itemToRemove = listV10[i];
        if (!itemToRemove) return;

        const roomId = itemToRemove.id; 
        const realId = parseInt(roomId) + 2; 

        // 2. X√≥a kh·ªèi m·∫£ng v√† l∆∞u b·ªô nh·ªõ
        listV10.splice(i, 1);
        localStorage.setItem('v10_list_cache', JSON.stringify(listV10));
        
        // 3. QUAN TR·ªåNG: G·ªçi loadRoomSchedules() thay v√¨ renderUI()
        // V√¨ h√†m n√†y m·ªõi l√† h√†m v·∫Ω c√°i danh s√°ch l·ªãch ƒë√®n
        loadRoomSchedules();

        // 4. G·ª¨I L·ªÜNH ƒê·ªíNG B·ªò XU·ªêNG ESP32 (G·ª≠i ƒë·ªß 3 g√≥i ƒë·ªÉ x√≥a h·∫≥n)
        let roomSchedules = listV10.filter(sch => String(sch.id) === String(roomId));
        let combinedData = "";
        
        for (let j = 0; j < 3; j++) {
            if (roomSchedules[j]) {
                combinedData += `id:${realId} ${roomSchedules[j].on} true ${roomSchedules[j].off} false;`;
            } else {
                combinedData += `id:${realId} 00:00 false 00:00 false;`;
            }
        }

        console.log(">>> ƒêang g·ª≠i l·ªánh x√≥a tri·ªát ƒë·ªÉ t·ªõi V0:", combinedData);

        const key = localStorage.getItem('userPass');
        fetch(WORKER_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: new URLSearchParams({
                'action': 'update',
                'pin': 'V0',
                'value': combinedData,
                'device': DEVICE_NAME,
                'key': key
            })
        }).then(r => {
            if(r.ok) console.log("‚úÖ ESP32 ƒë√£ nh·∫≠n l·ªánh x√≥a: " + combinedData);
        });
    }
}
//--------------------------------------
          
function syncV10ToESP() {
    let roomId = document.getElementById('v10_id').value;
    let roomSchedules = listV10.filter(sch => String(sch.id) === String(roomId)).slice(0, 3);
    
    // T·∫°o chu·ªói d·ªØ li·ªáu (N·∫øu kh√¥ng c√≥ l·ªãch th√¨ g·ª≠i chu·ªói r·ªóng ho·∫∑c m·∫∑c ƒë·ªãnh)
    let combinedData = roomSchedules.map(sch => {
        let realId = parseInt(sch.id) + 2;
        return `id:${realId} ${sch.on} true ${sch.off} false`;
    }).join(';') + ";";

    const key = localStorage.getItem('userPass');
    fetch(WORKER_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: new URLSearchParams({
            'action': 'update', 'pin': 'V0', 'value': combinedData, 'device': DEVICE_NAME, 'key': key
        })
    }).then(() => console.log(">>> ƒê√£ ƒë·ªìng b·ªô x√≥a t·ªõi V0: ", combinedData));
}
        // --- THAY TH·∫æ H√ÄM N√ÄY V√ÄO FILE HTML C·ª¶A B·∫†N ---
// --- THAY TH·∫æ H√ÄM N√ÄY V√ÄO FILE HTML C·ª¶A B·∫†N ---
function saveAllV10(btn) {
    btn.innerText = "‚è≥ ƒêANG G·ª¨I...";
    btn.disabled = true;

    // 1. L·∫•y ƒë√®n ƒëang ƒë∆∞·ª£c ch·ªçn
    let roomId = document.getElementById('v10_id').value;
    
    // 2. L·∫•y danh s√°ch l·ªãch hi·ªán c√≥ tr√™n Web cho ph√≤ng n√†y
    let roomSchedules = listV10.filter(sch => String(sch.id) === String(roomId));
    
    // 3. QUAN TR·ªåNG: T·∫°o chu·ªói d·ªØ li·ªáu lu√¥n ƒë·ªß 3 l·ªãch (ƒë·ªÉ ghi ƒë√®/x√≥a l·ªãch c≈© tr√™n ESP32)
    let realId = parseInt(roomId) + 2;
    let combinedData = "";
    
    for (let i = 0; i < 3; i++) {
        if (roomSchedules[i]) {
            // N·∫øu c√≥ l·ªãch tr√™n Web: G·ª≠i gi·ªù th·∫≠t
            let sch = roomSchedules[i];
            combinedData += `id:${realId} ${sch.on} true ${sch.off} false;`;
        } else {
            // N·∫øu kh√¥ng c√≥ (ƒë√£ b·ªã x√≥a ho·∫∑c ch∆∞a ƒë·∫∑t): G·ª≠i l·ªánh RESET ƒë·ªÉ ESP32 x√≥a h·∫≥n
            combinedData += `id:${realId} 00:00 false 00:00 false;`;
        }
    }
    
    console.log(`>>> G·ª≠i t·ªïng h·ª£p (3 g√≥i) t·ªõi V0:`, combinedData);

    const key = localStorage.getItem('userPass');

    // 4. G·ª≠i l√™n Cloud
    fetch(WORKER_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: new URLSearchParams({
            'action': 'update',
            'pin': 'V0',
            'value': combinedData,
            'device': DEVICE_NAME,
            'key': key
        })
    })
    .then(r => {
        if(r.ok) {
            alert(`‚úÖ ƒê√£ ƒë·ªìng b·ªô 3 l·ªãch cho Ph√≤ng ${roomId} (Bao g·ªìm x√≥a l·ªãch c≈© n·∫øu c√≥)`);
            btn.innerText = "‚úÖ OK";
            btn.style.background = "#95a5a6";
            setTimeout(() => {
                btn.innerText = "G·ª¨I & L∆ØU L·ªäCH ƒê√àN L√äN ESP32";
                btn.style.background = "";                
                btn.disabled = false;
            }, 2000);
        } else {
            alert("‚ùå L·ªói g·ª≠i d·ªØ li·ªáu!");
            btn.disabled = false;
        }
    })
    .catch(e => {
        alert("‚ùå L·ªói m·∫°ng!");
        btn.disabled = false;
    });
}
// --- THAY TH·∫æ H√ÄM N√ÄY V√ÄO FILE HTML C·ª¶A B·∫†N ---

        // --- C√ÅC H√ÄM C≈® GI·ªÆ NGUY√äN ---


function sendCmd(pin, value) {
    playClickSound();
    const key = localStorage.getItem('userPass');
    const onBtn = document.getElementById(`on-${pin}`);
    const offBtn = document.getElementById(`off-${pin}`);

    // 1. HI·ªÜU ·ª®NG T·ª®C TH√å: Nh·∫•n l√† xanh ngay ƒë·ªÉ c·∫£m gi√°c n√∫t nh·∫°y
    if (onBtn && offBtn) {
        if (value === 1) {
            onBtn.className = "btn btn-on active-on";
            offBtn.className = "btn btn-off";
        } else {
            onBtn.className = "btn btn-on";
            offBtn.className = "btn btn-off active-off";
        }
    }

    // 2. G·ª¨I L·ªÜNH L√äN CHIP
    fetch(WORKER_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: new URLSearchParams({
            'action': 'update',
            'pin': pin,
            'value': value,
            'device': DEVICE_NAME,
            'key': key
        })
    }).then(response => {
        if (!response.ok) {
            console.log("L·ªói g·ª≠i l·ªánh cho " + pin);
        }
    }).catch(e => console.log("M·∫•t k·∫øt n·ªëi m·∫°ng"));

    // 3. LOGIC C·ªòNG D·ªíN TH·ªúI GIAN (Nh∆∞ b·∫°n mu·ªën: max 2s cho 2 ƒë√®n ƒë·∫ßu, m·ªói ƒë√®n sau +0.5s)
    clickCounter++;
    // T√≠nh to√°n th·ªùi gian ch·ªù: ƒê√®n 1,2 ch·ªù 2s. T·ª´ ƒë√®n 3 tr·ªü ƒëi m·ªói ƒë√®n + 0.5s
    let waitTime = 2000;
    if (clickCounter > 2) {
        waitTime = 2000 + ((clickCounter - 2) * 500);
    }

    // X√≥a h·∫πn gi·ªù c≈© c·ªßa ch√¢n n√†y n·∫øu c√≥
    if (pendingChecks[pin]) clearTimeout(pendingChecks[pin]);

    // H·∫πn gi·ªù ƒë·ªÉ ki·ªÉm tra xem Chip c√≥ th·ª±c s·ª± b·∫≠t/t·∫Øt ch∆∞a
    pendingChecks[pin] = setTimeout(() => {
        updateStatusOnly(); // L·∫•y tr·∫°ng th√°i th·∫≠t t·ª´ Chip v·ªÅ
        
        clickCounter--;
        if (clickCounter < 0) clickCounter = 0;
        delete pendingChecks[pin];
        
        //console.log(`ƒê√£ ki·ªÉm tra l·∫°i tr·∫°ng th√°i ${pin} sau ${waitTime}ms`);
    }, waitTime);
}



       function updateStatusOnly() {
    const indicator = document.getElementById('status-indicator');
    if(indicator) indicator.style.background = "#f1c40f"; 
    const key = localStorage.getItem('userPass');

    fetch(WORKER_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: new URLSearchParams({
            'action': 'get_all',
            'device': DEVICE_NAME,
            'key': key
        })
    })
    .then(r => r.text())
    .then(text => {
        try {
            if (text.trim().startsWith('{')) {
                const data = JSON.parse(text);
                if(indicator) indicator.style.background = "#2ecc71";
                for (let p in data) {
                    let onBtn = document.getElementById(`on-${p}`);
                    let offBtn = document.getElementById(`off-${p}`);
                    if(onBtn && offBtn) {
                        let val = String(data[p]); 
                        if (val === "1" || val === "true") {
                            onBtn.className = "btn btn-on active-on";
                            offBtn.className = "btn btn-off";
                        } else {
                            onBtn.className = "btn btn-on";
                            offBtn.className = "btn btn-off active-off";
                        }
                    }
                }
            } else {
                if(indicator) indicator.style.background = "#e67e22"; 
            }
        } catch (err) {}
    })
    .catch(e => {
        if(indicator) indicator.style.background = "#e74c3c"; 
    });
}
      function addV2() {
    let t = document.getElementById('v2_t').value;
    let d = document.getElementById('v2_d').value;
    if(t && d) {
        if (listV2.length >= 6) return alert("T·ªëi ƒëa 6 l·∫ßn!");
        listV2.push({t, d}); renderUI(); 
    }
    
    
}
      function saveV2(btn) {
    let full = [];
    for(let i=0; i<6; i++) {
        if(listV2[i]) {
            let p = listV2[i].t.split(':');
            full.push({id:i+1, h:parseInt(p[0]), m:parseInt(p[1]), d:parseInt(listV2[i].d), a:true});
        } else {
            full.push({id:i+1, h:0, m:0, d:0, a:false});
        }
    }
    localStorage.setItem('v2_list_cache', JSON.stringify(listV2));
    const key = localStorage.getItem('userPass');

    // POST n·ªôi dung y h·ªát b·∫£n GET
    fetch(WORKER_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: new URLSearchParams({
            'action': 'update',
            'pin': 'V2',
            'value': JSON.stringify(full),
            'device': DEVICE_NAME,
            'key': key
        })
    }).then((response) => {
        if (response.ok) {
            btn.innerText = "‚úÖ ƒê√É X·ª¨ L√ù!"; 
            btn.style.background = "#2ecc71";
            setTimeout(() => { 
                btn.innerText = "G·ª¨I & L∆ØU L·ªäCH T∆Ø·ªöI"; 
                btn.style.background = ""; 
            }, 2000);
        }
    }).catch(e => {
        console.log("L·ªói m·∫°ng:", e);
    });
}


function uploadImg(pin) {
        let input = document.createElement('input');
        input.type = 'file';
        input.accept = 'image/*';
        input.onchange = e => {
            let file = e.target.files[0];
            if (!file) return;
            let reader = new FileReader();
            reader.onload = event => {
                let img = new Image();
                img.onload = () => {
                    let canvas = document.createElement('canvas');
                    let ctx = canvas.getContext('2d');
                    let MAX_WIDTH = 500;
                    let scale = MAX_WIDTH / img.width;
                    canvas.width = MAX_WIDTH;
                    canvas.height = img.height * scale;
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    let compressedData = canvas.toDataURL('image/jpeg', 0.6); // N√©n m·∫°nh h∆°n
                    try {
                        localStorage.setItem('img_' + pin, compressedData);
                        document.getElementById('img-tag-' + pin).src = compressedData;
                    } catch(e) { alert("·∫¢nh qu√° l·ªõn, kh√¥ng th·ªÉ l∆∞u!"); }
                };
                img.src = event.target.result;
            };
            reader.readAsDataURL(file);
        };
        input.click();
    }

      
function removeV2(i) {
    if(confirm("X√≥a l·ªãch?")) { 
        // 1. X√≥a ph·∫ßn t·ª≠ kh·ªèi m·∫£ng listV2 (Logic c≈© c·ªßa b·∫°n)
        listV2.splice(i, 1); 
        
        // 2. V·∫Ω l·∫°i giao di·ªán ngay l·∫≠p t·ª©c
        renderUI(); 
        
        // 3. G·ª≠i m·∫£ng m·ªõi l√™n Cloud ƒë·ªÉ ƒë·ªìng b·ªô (D√πng POST y chang h√†m saveV2)
        const key = localStorage.getItem('userPass');
        let full = [];
        for(let j=0; j<6; j++) {
            if(listV2[j]) {
                let p = listV2[j].t.split(':');
                full.push({id:j+1, h:parseInt(p[0]), m:parseInt(p[1]), d:parseInt(listV2[j].d), a:true});
            } else {
                full.push({id:j+1, h:0, m:0, d:0, a:false});
            }
        }
        // C·∫≠p nh·∫≠t b·ªô nh·ªõ ƒë·ªám
        localStorage.setItem('v2_list_cache', JSON.stringify(listV2));

        // G·ª≠i l·ªánh POST ƒëi
        fetch(WORKER_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: new URLSearchParams({
                'action': 'update',
                'pin': 'V2',
                'value': JSON.stringify(full),
                'device': DEVICE_NAME,
                'key': key
            })
        }).then(r => {
            console.log("ƒê√£ ƒë·ªìng b·ªô x√≥a l·ªãch V2 l√™n Cloud.");
        });
    }
}
       
let isUpdating = false; 
function editName(p) {
    if (isUpdating) return; 
    
    let oldName = (customNames[p] || p);
    let newName = prompt("T√™n m·ªõi cho " + p + ":", oldName);
    
    // N·∫øu ng∆∞·ªùi d√πng nh·∫•n Cancel ho·∫∑c kh√¥ng ƒë·ªïi t√™n th√¨ tho√°t
    if (!newName || newName === oldName) return;

    isUpdating = true; 

    // 1. C·∫≠p nh·∫≠t giao di·ªán ngay l·∫≠p t·ª©c ƒë·ªÉ ng∆∞·ªùi d√πng th·∫•y nhanh
    customNames[p] = newName;
    localStorage.setItem('last_config', JSON.stringify(customNames));
    renderUI();

    // 2. Chu·∫©n b·ªã d·ªØ li·ªáu g·ª≠i ƒëi (V1:T√™n c√≥ d·∫•u)
    const key = localStorage.getItem('userPass'); 
    const dataV13 = p + ":" + newName; 
    
    // QUAN TR·ªåNG: D√πng encodeURIComponent ƒë·ªÉ "b·ªçc" ti·∫øng Vi·ªát l·∫°i cho Worker
    const encodedValue = encodeURIComponent(dataV13);
    const urlV13 = `${WORKER_URL}?action=update&pin=V13&value=${encodedValue}&device=${DEVICE_NAME}&key=${key}`;
    
    console.log(">>> ƒêang g·ª≠i t√™n m·ªõi: " + dataV13);

   console.log(">>> ƒêang g·ª≠i t√™n m·ªõi b·∫±ng POST: " + dataV13);

    fetch(WORKER_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: `action=update&pin=V13&value=${encodeURIComponent(dataV13)}&device=${DEVICE_NAME}&key=${key}`
    })
    .then(response => {
        if (response.ok) console.log("‚úÖ Th√†nh c√¥ng!");
        isUpdating = false; 
    })
    .catch(err => {
        console.error("‚ùå L·ªói:", err);
        isUpdating = false;
    });
}
       function logout() {
    if (confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t kh√¥ng?")) {
        // X√≥a th·∫ª b√†i
        localStorage.removeItem('isLoggedIn');
        // V·ªÅ trang login (ƒë√£ s·ª≠a ƒë√∫ng t√™n file c·ªßa b·∫°n l√† login.html)
        window.location.replace('index.html');
    }
}
       function clearAllData() {
    if(confirm("C·∫¢NH B√ÅO: B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a s·∫°ch to√†n b·ªô c·∫•u h√¨nh? Vi·ªác n√†y s·∫Ω reset t√™n thi·∫øt b·ªã v√† th√¥ng b√°o Telegram v·ªÅ m·∫∑c ƒë·ªãnh!")) {
        
        // 1. X√≥a s·∫°ch b·ªô nh·ªõ tr√¨nh duy·ªát (LocalStorage)
        localStorage.clear();

        // 2. G·ª≠i l·ªánh t·∫Øt th√¥ng b√°o (V14 = 0) l√™n h·ªá th·ªëng
        const key = localStorage.getItem('userPass') || "1234567";
        fetch(WORKER_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: new URLSearchParams({
                'action': 'update',
                'pin': 'V14',
                'value': '0', // T·∫Øt th√¥ng b√°o khi x√≥a
                'device': DEVICE_NAME,
                'key': key
            })
        });

        alert("‚úÖ ƒê√£ x√≥a s·∫°ch d·ªØ li·ªáu tr√™n m√°y v√† t·∫Øt th√¥ng b√°o h·ªá th·ªëng!");
        
        // 3. ƒê∆∞a ng∆∞·ªùi d√πng v·ªÅ trang ƒëƒÉng nh·∫≠p ho·∫∑c t·∫£i l·∫°i trang
        window.location.replace('index.html');
    }
}
       async function saveTelegram() {
    const token = document.getElementById('tg_token').value.trim();
    const id = document.getElementById('tg_id').value.trim();
    const active = document.getElementById('tg_active').checked; // L·∫•y tr·∫°ng th√°i ƒë√∫ng sai
    
    if(!token || !id) return alert("Vui l√≤ng nh·∫≠p ƒë·ªß Token v√† Chat ID");

    const btn = event.target;
    btn.innerText = "‚è≥ ƒêANG L∆ØU...";
    btn.disabled = true;

    // 1. L∆∞u v√†o m√°y ng∆∞·ªùi d√πng ƒë·ªÉ Web nh·ªõ tr·∫°ng th√°i √¥ vu√¥ng
    localStorage.setItem('tg_config', JSON.stringify({token, id, active}));

    // 2. N·∫øu ng∆∞·ªùi d√πng T·∫ÆT √¥ vu√¥ng, Web b√°o lu√¥n v√† kh√¥ng g·ª≠i g√¨ l√™n Worker
    if (!active) {
        alert("ü§´ ƒê√£ t·∫Øt th√¥ng b√°o. Web s·∫Ω kh√¥ng g·ª≠i l·ªánh v·ªÅ Telegram.");
        btn.innerText = "L∆ØU V√Ä C·∫¨P NH·∫¨T";
        btn.disabled = false;
        return;
    }

    // 3. N·∫øu ng∆∞·ªùi d√πng B·∫¨T √¥ vu√¥ng, g·ª≠i 1 tin nh·∫Øn th·ª≠ nghi·ªám l√™n Worker
    const secret = localStorage.getItem('userPass') || "1234567";
    try {
        const response = await fetch(WORKER_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: new URLSearchParams({
                'action': 'send_tg', // G·ªçi l·ªánh g·ª≠i tin nh·∫Øn tr·ª±c ti·∫øp
                'tgToken': token,
                'tgId': id,
                'msg': '‚úÖ Thi·∫øt b·ªã c·ªßa b·∫°n ƒë√£ k·∫øt n·ªëi Telegram th√†nh c√¥ng!',
                'key': secret,
                'device': DEVICE_NAME
            })
        });

        if (response.ok) {
            alert("‚úÖ X√ÅC NH·∫¨N: Worker ƒë√£ th√¥ng su·ªët v√† ƒë√£ g·ª≠i tin nh·∫Øn th·ª≠!");
        } else {
            alert("‚ùå L·ªói 401: Sai m·∫≠t m√£ User Key!");
        }
    } catch (e) {
        alert("‚ùå L·ªói k·∫øt n·ªëi t·ªõi Worker!");
    } finally {
        btn.innerText = "L∆ØU V√Ä C·∫¨P NH·∫¨T";
        btn.disabled = false;
    }
}


      
    </script>
</body>
</html>
